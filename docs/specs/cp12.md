# CP12 / Landlord Gas Safety Record – Specification

## Purpose
- CertNow CP12 (Landlord Gas Safety Record).
- One certificate per job/property; includes all appliances/flues checked during the visit.

## Legal Minimum Fields (record-level job_fields)
- `property_address` (required)
- `inspection_date` (required)
- `landlord_name` (required)
- `landlord_address` (required)
- `engineer_name` (required)
- `gas_safe_number` (required)
- `reg_26_9_confirmed` (boolean, required)
- `defect_description` (required if defects exist)
- `remedial_action` (required if defects exist)

### Appliance-level (cp12_appliances table)
- `location` (required)
- `description` (required; mapped to `appliance_type`)
- `checked_date` (optional; defaults to `inspection_date` when omitted)

### Signatures
- `engineer_signature` (required for final issue)
- `customer_signature` (required for final issue)

### Clarifications
- One CP12 record covers ALL appliances/flues checked at the property.
- Drafts may be saved incomplete; final PDF generation must enforce minimum requirements.

## Validation Rules
- Block final PDF generation unless all required record-level fields are present **and** at least one appliance row exists (each with `location` and `description`).
- If any defect info is present, both `defect_description` and `remedial_action` must be provided.
- Signatures (engineer + customer) and Regulation 26(9) confirmation are required before issuing.
- Draft saves do **not** enforce these rules.

## PDF Sections
- Header: “Gas Safety Record (CP12)”
- Property details
- Landlord/Agent details
- Engineer details
- Appliance/Flue table
- Defects & remedial actions
- Regulation 26(9) confirmation
- Signatures & issued timestamp

This specification is the single source of truth for CP12 validation, UI, and PDF generation.

## Demo & Dropdown Options
- Demo autofill (dev or `NEXT_PUBLIC_DEMO_MODE=true`) uses:
  - Job fields: John Smith @ 15 Acacia Avenue, SW1A 1AA; inspection date today; landlord/agent John Smith @ 12 Example Road, SW1A 1AA; engineer Alex Turner, Gas Safe 123456; company CertNow Heating Services Ltd; Reg 26(9) confirmed; defect note “No safety defects identified…”.
  - Appliance: Combi boiler (Worcester Bosch Greenstar 30i) in Kitchen cupboard; 20 mbar; 24 kW; room sealed; ventilation adequate; all safety checks pass; CO 8ppm; safety rating safe; no classification code.
- Appliance dropdowns (values are stored as stable lowercase strings):
  - Appliance type: Combi boiler, System boiler, Back boiler, Gas fire, Gas hob, Cooker, Water heater, Other
  - Flue type: Room sealed, Open flue, Balanced flue, Flueless, Other
  - Location: Kitchen, Kitchen cupboard, Utility room, Bathroom, Hallway, Bedroom, Living room, Loft, Garage, External, Other
  - Ventilation provision: Adequate ventilation, Permanent ventilation present, No permanent ventilation required, Ventilation inadequate
